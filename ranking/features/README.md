# Ranking Model Features

## Feature Set v1.0

Created: 2026-01-08 19:59:17

## Files

- `train_features.parquet`: Training features (800,167 rows)
- `val_features.parquet`: Validation features (23,636 rows)
- `test_features.parquet`: Test features (80,298 rows)
- `feature_metadata.json`: Feature schema and metadata

## Feature Categories (35 features total)

### User Aggregation Features (5)
Computed from training data only:
- user_rating_count: Number of ratings given
- user_avg_rating: Mean rating given
- user_rating_std: Std dev of ratings
- user_rating_min: Minimum rating
- user_rating_max: Maximum rating

### Movie Aggregation Features (5)
Computed from training data only:
- movie_rating_count: Number of ratings received (popularity)
- movie_avg_rating: Mean rating received (quality)
- movie_rating_std: Std dev (polarization)
- movie_rating_min: Minimum rating
- movie_rating_max: Maximum rating

### User-Movie Interaction Features (4)
- user_movie_rating_diff: user_avg - movie_avg
- user_rating_count_norm: log1p(user_rating_count)
- movie_rating_count_norm: log1p(movie_rating_count)
- user_movie_activity_product: user_norm * movie_norm

### Demographic Features (3)
- gender: Binary (M=1, F=0)
- age_group: 7 age bins (1, 18, 25, 35, 45, 50, 56)
- occupation: 21 occupation codes (0-20)

### Genre Features (18)
Multi-hot encoding of movie genres:
genre_action, genre_adventure, genre_animation, genre_childrens, genre_comedy, genre_crime, genre_documentary, genre_drama, genre_fantasy, genre_film_noir, genre_horror, genre_musical, genre_mystery, genre_romance, genre_sci_fi, genre_thriller, genre_war, genre_western

## Data Leakage Prevention

- User/movie aggregations computed **only from training data**
- Same statistics applied to val/test (frozen at train time)
- Cold-start users/movies receive global defaults
- No future information used in feature computation

## Usage

```python
import pandas as pd

# Load features
train = pd.read_parquet('train_features.parquet')
val = pd.read_parquet('val_features.parquet')
test = pd.read_parquet('test_features.parquet')

# Separate features and target
feature_cols = [col for col in train.columns
                if col not in ['user_id', 'movie_id', 'rating', 'timestamp']]
X_train = train[feature_cols]
y_train = train['rating']
```

## Generation

This feature set was generated by `build_features.py`.
To regenerate: `python -m ranking.features.build_features`
